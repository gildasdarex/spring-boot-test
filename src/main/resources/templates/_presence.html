<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorator="layout">
<head>
  <title>Programme Emploi Jeune</title>
</head>
<body>
 
  <div layout:fragment="content">
        <!-- page content -->
			 <!-- page content -->
		<script type="text/javascript" th:inline="javascript">
		    /*<![CDATA[*/
		   
	    	function upgradeCandidat(url, element){
		    	  var path= /*[[@{/pej/candidats/valider/}]]*/;
		    	  console.log('Path:', path);
		    	  console.log('url: ', url);
		    	  console.log('Element: ', element);
		    	  var element1=$(element).find('td > a')[0];
		    	  console.log('Element1:', $(element1));
		    	 
		    	  
		    	  var validerCandidat=function(jqXHR){
		    		  console.log('jqXHR.responseText:',jqXHR.responseText);
		    		  //var currentCandidat = jQuery.parseJSON( jqXHR.responseText );
	  				  console.log('Ajax response error:',currentCandidat);
	  				 $(element1).text(currentCandidat.statutcandidat.intitule);
		    	  }
		    	  doGet(path+url, validerCandidat);
	      	}
	    	 function doGet(url, setCommune) {
	    		 var data;
	    		 $.ajax({
	    			 url : 'http://localhost:8080'  + url,
	    			 type : 'GET' ,
	    			 dataType : 'application/json' ,
	    			 beforeSend : function() {
	    			 },
	    			 success : function(data) {
	    				console.log('Show success response: ', data);
	    			 },
	    			 complete : function() {
	    				console.log('Ajax response complete');
	    			 },
	    			 error : function(jqXHR) {
	    				 setCommune(jqXHR);
	    			 }
	    		 })
	    		 
	    		 return data;
	    	}
	    	 
		    /*]]>*/
  </script>	 
        <div class="right_col" role="main">
          <div class="">


            <div class="clearfix"></div>
			<div th:with="notifyMessages=${session[T(com.pej.services.NotificationServiceImpl).NOTIFY_MSG_SESSION_KEY]}">	
				  <div th:each="msg : ${notifyMessages}"  class="alert alert-success alert-dismissible fade in" th:classappend="'alert-'+${#strings.toLowerCase(msg.type)}" role="alert">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span>
					</button>
					<strong th:text="${msg.text}"></strong>
				  </div>
				  <span th:if="${notifyMessages}" th:remove="all" th:text="${session.remove(T(com.pej.services.NotificationServiceImpl).NOTIFY_MSG_SESSION_KEY)}"></span>
			</div>
            <div class="row">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                      <h2  data-th-text=" 'LISTE DES CANDDATS NON PRESENT POUR LA FORMATION ' + ${formation.intitule} "></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                     <div class="row" >
							 <a style="margin-left: 8px;" href="#" th:href="@{/pej/candidats/add}" class="btn btn-info"><i class="fa fa-plus"></i> Ajouter</a>
					</div>
                    <div class="table-responsive">
                      <table id="datatable-buttons" class="table table-striped table-bordered display nowrap"  cellspacing="0" width="100%">
                        <thead>
                          <tr class="headings">
                            <th>
                              <input type="checkbox" id="check-all" class="flat"/>
                            </th>
                            <th class="column-title">Candidat </th>
                            <th class="column-title">Commune </th>
                            <th class="column-title">Téléphone </th>
                            <th class="column-title">Sexe</th>
                            <th class="column-title">Date naissance </th>
                            <th class="column-title">Statut </th>
                            <th class="column-title no-link last"><span class="nobr">Action</span>
                            </th>
                            <!-- th class="bulk-actions" colspan="7">
                              <a class="antoo" style="color:#fff; font-weight:500;">Bulk Actions ( <span class="action-cnt"> </span> ) <i class="fa fa-chevron-down"></i></a>
                            </th-->
                          </tr>
                        </thead>

                        <tbody>
                         <tr data-th-each="candidat : ${candidats}" class="even pointer">
	                            <td class="a-center ">
	                              <input type="checkbox" class="flat" name="table_records"/>
	                            </td>
								<td class=" " data-th-text="${candidat.nom +' '+candidat.prenom}"></td>
								<td class=" " data-th-text="${candidat.localcommune}" ></td>
								<td class=" " data-th-text="${candidat.telprincipal}"></td>
								<td class=" " data-th-text="${candidat.sexe}"></td>
								<td class=" "  data-th-text="${#dates.format(candidat.datenaissance,'dd/MM/yyyy')}"></td>
							
		                        <td>
		                            <a class="btn btn-success btn-xs"  data-th-text="${candidat.statutcandidat.intitule}"></a>
		                        </td>
	                            <td class=" ">
	                            	<!--  -->
	                            	<a href="#"  class="link btn btn-success btn-xs" th:href="@{'/pej/formationbeneficiaires/' + ${formation.idformation} +'/presence/'+${candidat.idcandidat}}"><i class="fa fa-check-square-o"></i> Présent(e) </a>
	                            </td>
                          
							</tr>
                        </tbody>
                      </table>
         
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          
                    <div class="">


            <div class="clearfix"></div>

            <div class="row">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                      <h2  data-th-text=" 'LISTE DES CANDDATS PRESENT POUR LA FORMATION ' + ${formation.intitule} "></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                     <div class="row" >
							 <a style="margin-left: 8px;" href="#" th:href="@{/pej/candidats/add}" class="btn btn-info"><i class="fa fa-plus"></i> Ajouter</a>
					</div>
                    <div class="table-responsive">
                      <table id="datatable-buttons" class="table table-striped table-bordered display nowrap"  cellspacing="0" width="100%">
                        <thead>
                          <tr class="headings">
                            <th>
                              <input type="checkbox" id="check-all" class="flat"/>
                            </th>
                            <th class="column-title">Candidat </th>
                            <th class="column-title">Commune </th>
                            <th class="column-title">Téléphone </th>
                            <th class="column-title">Sexe</th>
                            <th class="column-title">Date naissance </th>
                            <!--th class="column-title">Date enregistrement </th>
                            < th class="column-title">Agent Enregistreur </th>
                            <th class="column-title">Niveau validation </th-->
                            <th class="column-title">Agent </th>
                            <th class="column-title">Nbre de jours </th>
                           
                            <th class="column-title">Statut </th>
                            <th class="column-title no-link last"><span class="nobr">Action</span>
                            </th>
                            <!-- th class="bulk-actions" colspan="7">
                              <a class="antoo" style="color:#fff; font-weight:500;">Bulk Actions ( <span class="action-cnt"> </span> ) <i class="fa fa-chevron-down"></i></a>
                            </th-->
                          </tr>
                        </thead>

                        <tbody>
                         <tr data-th-each="presence : ${presences}" class="even pointer">
	                            <td class="a-center ">
	                              <input type="checkbox" class="flat" name="table_records"/>
	                            </td>
								<td class=" " data-th-text="${presence.candidat.nom +' '+presence.candidat.prenom}"></td>
								<td class=" " data-th-text="${presence.candidat.localcommune}"></td>
								<td class=" " data-th-text="${presence.candidat.telprincipal}"></td>
								<td class=" " data-th-text="${presence.candidat.sexe}"></td>
								<td class=" " data-th-text="${#dates.format(presence.candidat.datenaissance,'dd/MM/yyyy')}"></td>
								<td class=" " data-th-text="${presence.candidat.agent.nom+' '+presence.candidat.agent.prenom}"></td>
								<td class=" " data-th-text="${presence.nbpresence}"></td>
								<td class=" ">
									 <a class="btn btn-success btn-xs"  data-th-text="${presence.candidat.statutcandidat.intitule}"></a>
								</td>
		                        
	                            <td class=" ">
	                            	<a href="#"  class="btn btn-xs btn-info" th:href="@{'/pej/presence/add/'+ ${presence.idpresence}}" >
	                            		<i class="fa  fa-plus" data-toggle="tooltip" title="Enlever"></i> Ajouter présence
	                            	</a>
	                            	<a href="#"  class="btn btn-xs btn-danger" th:href="@{'/pej/formationbeneficiaires/rm/' + ${formation.idformation} +'/presence/'+${presence.candidat.idcandidat}}" >
	                            	<i class="fa fa-trash" data-toggle="tooltip" title="Enlever"></i> Absent(e) </a>
	                            </td>
                          
							</tr>
                        </tbody>
                      </table>
         
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- /page content -->
        <!-- /page content -->    
  </div>

  <footer>
    <p layout:fragment="custom-footer">This is some footer content from content page 1</p>
  </footer>
  

</body>
</html>